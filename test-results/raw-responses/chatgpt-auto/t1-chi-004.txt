For an (r\times c) Pearson chi-square test of independence, Cohen’s effect size (w) relates to the **noncentrality parameter** by

[
\lambda = N,w^2,
]

and the degrees of freedom are

[
\nu = (r-1)(c-1).
]

### 1) Set up the test

* Table: (4\times 4 \Rightarrow \nu=(4-1)(4-1)=9)
* Target: power (=0.90)
* Significance: (\alpha=0.01)
* Effect size: (w=0.20) (small)

The rejection threshold is the central chi-square critical value
[
c = \chi^2_{1-\alpha,\nu}=\chi^2_{0.99,9}\approx 21.67.
]

### 2) Power relationship (noncentral chi-square)

Under the alternative, the test statistic approximately follows a **noncentral chi-square**:
[
X^2 \sim \chi^2_{\nu}(\lambda),
]
so power is
[
\text{Power} = P!\left(\chi^2_{\nu}(\lambda) > c\right).
]

Solving this exactly usually requires software (noncentral chi-square CDF). A good closed-form approximation uses a normal approximation to the noncentral chi-square:

* Mean (\approx \nu+\lambda)
* Variance (\approx 2(\nu+2\lambda))

So
[
P(X^2>c)\approx 1-\Phi!\left(\frac{c-(\nu+\lambda)}{\sqrt{2(\nu+2\lambda)}}\right).
]

Set this equal to 0.90, i.e. the inside should be (-z_{0.90}) where (z_{0.90}\approx 1.2816):

[
\frac{\nu+\lambda-c}{\sqrt{2(\nu+2\lambda)}} \approx 1.2816.
]

Plugging (\nu=9), (c\approx 21.67) and solving gives
[
\lambda \approx 27.1.
]

### 3) Convert (\lambda) to total sample size (N)

[
N = \frac{\lambda}{w^2}=\frac{27.1}{0.20^2}=\frac{27.1}{0.04}\approx 677.5.
]

## Answer

You need **about (\boxed{N \approx 680})** total observations (rounding up), i.e. roughly **(\boxed{N=677\text{ to }680})** total.

### Practical note

This assumes the chi-square approximation is valid (expected counts not too small). If you anticipate sparse cells in a (4\times 4) genotype–phenotype table, you may want to **inflate (N)** a bit or consider an exact/Monte Carlo approach.
